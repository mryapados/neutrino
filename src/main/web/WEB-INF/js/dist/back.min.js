!function(){var a=angular.module("backApp",["backServices","ngSanitize","pascalprecht.translate","ngCookies","ngResource","frontApp"]);a.config(function(a){var b;angular.injector(["ngCookies"]).invoke(["$cookies",function(a){b=a}]),a.useSanitizeValueStrategy("sanitize");var c=b.get("language");void 0==c&&(c="en"),a.preferredLanguage(c),a.useLoader("i18nLoader")}),a.run(function(a){}),a.factory("i18nLoader",function(a,b,c){return function(d){var e=b.defer();return a.get(c.URL_SERVER_REST+"@front/labels/"+d.key).then(function(a){e.resolve(a.data)}).catch(function(a){console.log(a.status),console.log(a),e.reject(d.key)}),e.promise}})}();var bModule=angular.module("backApp");bModule.controller("BlockManagementCtrl",function(a,b,c,d){a.init=function(b,d,e){c.init(b,d,e).then(function(){a.BlockManagementFacade=c})}});var bModule=angular.module("backApp");bModule.controller("BlockSelectionCtrl",function(a){a.currentLang="",a.switchLang=function(b){a.currentLang=b},a.openValue=!1,a.switchDisplay=function(){a.openValue=!a.openValue}});var bModule=angular.module("backApp");bModule.controller("ModalDemoCtrl",function(a,b,c){a.items=["item1","item2","item3"],a.open=function(d){var e,f=a.$new();f.ok=function(){e.close(f.selected)},f.cancel=function(){e.dismiss("cancel")},e=b.open({template:"<my-modal></my-modal>",size:d,scope:f}),e.result.then(function(b){a.selected=b},function(){c.info("Modal dismissed at: "+new Date)})}});var bModule=angular.module("backApp");bModule.controller("TemplateModalCtrl",function(a,b,c,d,e,f){a.exist=function(){return f.getExist(e.context,d.kind,d.path,d.name).then(function(b){a.scriptExist={exist:b,path:'"...'+d.path+"/"+d.name+'.jsp"'}})},a.cancel=function(){b.dismiss("cancel")},a.cancel=function(){b.dismiss("cancel")},a.updateTemplate=function(c){c.$valid?f.saveTemplate(d).then(function(a){b.close(a)}).catch(function(b){a.template.errors=b}).finally(function(){}):b.dismiss("cancel")},a.template={templateModal:c.URL_TEMPLATE_MODAL,template:d,errors:null},a.exist()});var bModule=angular.module("backApp");bModule.controller("UiPositionCtrl",function(a,b,c,d,e){d.getTemplate(a.model).then(function(d){var f=d,g=a.position,h=a.activeobject;a.modelKind=f.kind,b.getBlocksForModelPosition(f.name,h,g).then(function(b){a.blocks=b}),a.$on("dropEvent_"+g+"@"+f.name,function(b,c,d){e.setMapBlock(f.name,c.name,d.name,d.ordered).then(function(b){d.ordered<0?a.blocks.splice(0,0,b):a.blocks.push(b)})}),a.remove=function(b){c.remove(a.blocks[b].idMapTemplate).then(function(c){a.blocks.splice(b,1)})}})}),function(){var a=angular.module("backApp");a.directive("drag",["$rootScope",function(a){function b(a,b,c){b.addClass(c),a.originalEvent.dataTransfer.setData("id",a.target.id),a.originalEvent.dataTransfer.effectAllowed="move"}function c(a,b,c){b.removeClass(c)}return{restrict:"A",link:function(d,e,f){f.$set("draggable","true"),d.dragStyle=f.dragstyle,e.bind("dragstart",function(c){a.draggedElement=d[f.drag],b(c,e,d.dragStyle)}),e.bind("dragend",function(a){c(a,e,d.dragStyle)})}}}]),a.directive("drop",["$rootScope",function(a){function b(a,b,c){a.preventDefault(),b.addClass(c)}function c(a,b,c){b.removeClass(c)}function d(a){a.preventDefault()}function e(a,b,c){a.preventDefault(),b.removeClass(c)}return{restrict:"A",link:function(f,g,h){f.dropStyle=h.dropstyle,g.bind("dragenter",function(a){b(a,g,f.dropStyle)}),g.bind("dragleave",function(a){c(a,g,f.dropStyle)}),g.bind("dragover",d),g.bind("drop",function(b){e(b,g,f.dropStyle);var c=f.model;if(f[h.drop])dropData=f[h.drop];else{var d=h.drop.split("-"),i=0;i="top"==d[1]?-1:1,dropData={name:d[0],ordered:i}}var j="dropEvent_"+dropData.name+"@"+c;a.$broadcast(j,a.draggedElement,dropData)})}}}]),a.directive("uiPosition",function(a,b){return{scope:{position:"@",model:"@",activeobject:"@"},restrict:"E",templateUrl:a.URL_TEMPLATE_JS+"ui-position.html",controller:"UiPositionCtrl",link:function(a,c,d){a.facade=b}}}),a.directive("myModal",function(){return{restrict:"E",templateUrl:"myModalContent.html",controller:function(a){a.selected={item:a.items[0]}}}})}(),function(){var a=angular.module("backServices",[]);a.config(function(a){a.interceptors.push("Interceptor")}),a.factory("Interceptor",function(a){return{responseError:function(b){return 404===b.status?(b.data='<div class="bg-danger"><h2>Object not found</h2><p>'+b.config.url+"</p></div>",a.resolve(b)):a.reject(b)}}})}(),function(){var a=angular.module("backServices");a.service("BlockManagementService",function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n=null;self=this;var o;self.getTemplates=function(){return o};var p;self.getLangs=function(){return p},self.init=function(a,c,e){var f=b.defer();d.getFolder(a).then(function(a){l=a}).then(function(){self.initPage(c)}).then(function(){null!=e&&j.getTObject(e).then(function(a){n=a})}).then(function(){self.initLangs()}).then(function(){self.initTemplates()}).catch(function(a){console.log("errrrrrrrrrrrrrrrrrrrrror"),console.log(a)}).finally(function(){f.resolve()});return f.promise},self.initFolder=function(a){var c=b.defer();return l?c.resolve():d.getFolder(a).then(function(a){l=a,c.resolve()}),c.promise},self.initPage=function(a){var c=b.defer();return m?c.resolve():f.getPage(a).then(function(a){m=a,c.resolve()}),c.promise},self.initLangs=function(){var a=b.defer();return p?a.resolve():e.getLangs().then(function(b){p=b,a.resolve()}),a.promise},self.initTemplates=function(){var a=b.defer();return o?a.resolve():g.getTemplates().then(function(b){o=b,a.resolve()}),a.promise},self.getParsedBlock=function(a){return k.URL_SERVER_REST+"@back/parsedblock/"+m.name+"/"+a+"?servername="+l.serverName[0]},self.setMapBlock=function(a,c,d,e){var f={modelName:a,blockName:c,positionName:d,ordered:e},g=b.defer();return i.save(f).then(function(a){g.resolve(a)}),g.promise},self.getPathTemplateForm=function(){return k.URL_TEMPLATE_MODAL},self.openModal=function(a){c.open({templateUrl:k.URL_TEMPLATE_MODAL_EDIT,controller:"TemplateModalCtrl",resolve:{template:function(){return g.getTemplate(a)},page:function(){return m}}}).result.then(function(a){})}}),a.service("TemplateService",function(a,b,c){self=this,self.getTemplate=function(b){return a.get({name:b}).$promise},self.getTemplates=function(){return a.getAll().$promise},self.getExist=function(a,c,d,e){return b.exist(a,c,d,e)},self.saveTemplate=function(b){return(b.id?a.update:a.create).call(a,{},b).$promise}}),a.service("LangService",function(a,b){self=this,self.getLang=function(b){return a.get({name:b}).$promise},self.getLangs=function(){return a.getAll().$promise}}),a.service("FolderService",function(a,b){self=this,self.getFolder=function(b){return a.get({name:b}).$promise},self.getFolders=function(){return a.getAll().$promise}}),a.service("PageService",function(a,b){self=this,self.getPage=function(b){return a.get({name:b}).$promise},self.getPages=function(){return a.getAll().$promise}}),a.service("TObjectService",function(a,b){self=this,self.getTObject=function(b){return a.get({id:b}).$promise}}),a.service("BlockService",function(a,b){self=this,self.getBlocksForModelPosition=function(b,c,d){return a.getAll({model:b,activeobject:c,position:d}).$promise}}),a.service("PositionService",function(a,b){self=this,self.getPosition=function(b){return a.get(b)},self.getPositions=function(){return a.getAll()}}),a.service("MapTemplateService",function(a,b){self=this,self.save=function(b){return(b.id?a.update:a.save).call(a,{},b).$promise},self.remove=function(b){return a.remove({id:b}).$promise}})}(),function(){angular.module("backServices").constant("$backPath",{URL_SERVER_REST:"/neutrino/",URL_TEMPLATE_JS:"/neutrino/js/src/back/templates/",URL_TEMPLATE_MODAL:"/neutrino/js/src/back/views/templateForm.html",URL_TEMPLATE_MODAL_ADD:"/neutrino/js/src/back/views/modalTemplateFormAdd.html",URL_TEMPLATE_MODAL_EDIT:"/neutrino/js/src/back/views/modalTemplateFormEdit.html"})}(),function(){var a=angular.module("backServices");a.factory("TemplateRepository",function(a,b){return{exist:function(c,d,e,f){return a.get(b.URL_SERVER_REST+"@back/templates/exist/",{params:{context:c,kind:d,path:e,name:f}}).then(function(a){return a.data}).catch(function(a){console.log(a.status),console.log(a)})}}}),a.factory("TemplateResource",function(a,b){return a(b.URL_SERVER_REST+"@back/templates/:name",{name:"@name"},{create:{method:"POST"},get:{method:"GET"},getAll:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"}})}),a.factory("LangResource",function(a,b){return a(b.URL_SERVER_REST+"@back/langs/:name",{name:"@name"},{create:{method:"POST"},get:{method:"GET"},getAll:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"}})}),a.factory("FolderResource",function(a,b){return a(b.URL_SERVER_REST+"@back/folders/:name",{name:"@name"},{create:{method:"POST"},get:{method:"GET"},getAll:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"}})}),a.factory("PageResource",function(a,b){return a(b.URL_SERVER_REST+"@back/pages/:name",{name:"@name"},{create:{method:"POST"},get:{method:"GET"},getAll:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"}})}),a.factory("BlockResource",function(a,b){return a(b.URL_SERVER_REST+"@back/models/:model/activeobjects/:activeobject/positions/:position/blocks",{model:"@model",activeobject:"@activeobject",positions:"@position"},{create:{method:"POST"},get:{method:"GET"},getAll:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"}})}),a.factory("PositionRepository",function(a,b){return{get:function(c){return a.get(b.URL_SERVER_REST+"@back/positions/"+c).then(function(a){return a.data}).catch(function(a){console.log(a.status),console.log(a)})},getAll:function(){return a.get(b.URL_SERVER_REST+"@back/positions/").then(function(a){return a.data}).catch(function(a){console.log(a.status),console.log(a)})}}}),a.factory("MapTemplateRepository",function(a,b){return{remove:function(c){return a.delete(b.URL_SERVER_REST+"@back/removemapblock/"+c).then(function(a){}).catch(function(a){console.log(a.status),console.log(a)})},add:function(c){return a.post(b.URL_SERVER_REST+"@back/addmapblock",c).then(function(a){return a.data}).catch(function(a){console.log(a.status),console.log(a)})}}}),a.factory("MapTemplateResource",function(a,b){return a(b.URL_SERVER_REST+"@back/maptemplates/:id",{id:"@id"},{save:{method:"POST"},get:{method:"GET"},getAll:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"}})}),a.factory("TObjectResource",function(a,b){return a(b.URL_SERVER_REST+"@back/tobjects/:id",{id:"@id"},{save:{method:"POST"},get:{method:"GET"},getAll:{method:"GET",isArray:!0},remove:{method:"DELETE"},update:{method:"PUT"}})})}();